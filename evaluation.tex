\chapter{Evaluation}
\label{chap:evaluation}

Dieses Kapitel widmet sich der Auswertung der Ergebnisse anhand verschiedener Metriken. Eingebettet in der Transformationssoftware befindet sich ein Präprozessor, der die aufgenommen Daten vor der Transformation manipulieren kann. Auf diese Weise werden mehrere Trainingsdatensätze erstellt, die in der Evaluation daraufhin analysiert werden, wie genau ein Klassifikator nach dem Training mit ihnen Vorhersagen treffen kann.

Die folgenden Datensätze werden generiert:

\begin{enumerate}
\item \textit{Combined}: Alle Daten werden ohne Veränderungen mit in die Transformation einbezogen.
\item \textit{NoisyBandTimestamps}: Die Zeitstempel der Readings des Bands werden mit gaussschem Rauschen versehen
\item \textit{Band combined}: Alle Daten des Smartphones werden vor der Transformation verworfen, sodass nur noch die Daten des Band verbleiben..
\item \textit{Band accel}: Nur die Daten des Beschleunigungssensors des Microsoft Band 2 werden mit in die Transformation einbezogen.
\item \textit{Band gyro}: Nur die Daten des Gyroskops des Microsoft Band 2 werden mit in die Transformation einbezogen.
\item \textit{Phone comb.}: Alle Daten des Microsoft Band 2 werden vor der Transformation verworfen, sodass nur noch die Daten des Smartphones verbleiben.
\item \textit{Phone accel}: Nur die Daten des Beschleunigungssensors des Smartphones werden mit in die Transformation einbezogen.
\item \textit{Phone gyro}: Nur die Daten des Gyroskops des Smartphones werden mit in die Transformation einbezogen.
\item \textit{SamplingRate1Hz}: Es werden Readings verworfen, als hätten Band und Smartphone jeweils nur Readings bei einer Rate von 1 Hz geliefert.
\item \textit{SamplingRate5Hz}: Es werden Readings verworfen, als hätten Band und Smartphone jeweils nur Readings bei einer Rate von 5 Hz geliefert.
\end{enumerate}

\todo{Genauigkeiten aus Weiss zum Vergleich mit einbinden}

\section{Effektivität der Datenkombination}
In diesem Abschnitt widmen wir uns der Frage, wie effektiv die Kombination der Daten von Band und Smartphone hinsichtlich der Vorhersagegenauigkeit gegenüber einer einzigen Datenquelle ist. Weiss et al.\cite{Weiss2016} werten in ihrem Papier die Genauigkeit von Modellen aus, die entweder auf Daten des Beschleunigungssensors eines Smartphones, des Beschleunigungssensors einer Smartwatch oder des Gyroskops einer Smartwatch zurückgreifen. Eine Kombination der Daten schlagen die Autoren vor, führen diese allerdings nicht durch.

Abbildung~\ref{fig:accuracy-personal} zeigt die Genauigkeit der persönlichen Modelle und Abbildung~\ref{fig:accuracy-impersonal} die der unpersönlichen Modelle. Ein persönliches Modell basiert auf Daten des jeweiligen Benutzers, während ein unpersönliches Modell noch keine Daten des Nutzers gesehen hat, für den eine Vorhersage getroffen werden soll. Die \textit{Genauigkeit} ist definiert als der Anteil der korrekt klassifizierten Instanzen, die dem Modell zum Test vorgelegt wurden.

Die erste Spalte der in diesem Abschnitt referenzierten Tabellen gibt den Algorithmus an, der zur Klassifikation verwendet wurde. Eine Erläuterung der Algorithmen ist in Abschnitt~\ref*{section:ml-algos}
zu finden. Fettgedruckt ist immer der jeweils höchste Wert einer Spalte.

\subsection{Persönliche Modelle}

Die Evaluierung der persönlichen Modelle erfolgt wie folgt: Für jeden Benutzer $b$ wird eine 10-fache Kreuzvalidierung \todo{hab ich das schon erklärt?} durchgeführt, wobei die Trainingsdaten nur Daten von $b$ beinhalten. Anschließend wird der Durchschnitt der einzelnen Genauigkeiten über alle Benutzer gebildet, um einen globalen Genauigkeitswert zu erhalten.

Nutzt man nur je ein Gyroskop, ist die Qualität der persönlichen Modelle am schlechtesten. Im Gegensatz dazu haben bereits Modelle, die lediglich Daten von einem der Beschleunigungssensoren verwenden, eine gute Aussagekraft. Weiss et al.\cite{Weiss2016} stellten in ihrem Experiment fest, dass die Genauigkeit des \textit{Phone accel}-Modells $17.8 \%$ über dem \textit{Watch accel / Band accel}-Modell lag. In unserem Experiment ist der Unterschied trotz gleichem Experimentaufbau mit $1.6 \%$ weit geringer. Eine denkbare Erklärung wäre, dass die Probanden von Weiss et al. über verschiedene Aktivitäten hinweg mehr Variation bei ihrer Bewegung des Unterkörpers eingebracht haben könnten.

Vergleicht man die beste Datenquelle (Band accel) mit den Kombinationsmöglichkeiten, so lässt sich feststellen, dass schon die Hinzunahme des Band-Gyroskops eine Genauigkeit von $97.1 \%$ erzielt, wohingegen die Kombination der beiden Smartphone-Sensoren lediglich eine Verbesserung von $0.7 \%$ gegenüber \textit{Phone accel} und gegenüber \textit{Band accel} sogar eine Verschlechterung erwirkt. Hebt man jedoch die künstlichen Einschränkungen auf, so wird eine Genauigkeit von $99.4 \%$ erreicht, sodass Benutzer nach dreiminütiger Aufnahme einer Aktivität bedenkenlos davon ausgehen könnten, dass diese in Zukunft in aller Regel automatisch erkannt wird. Insgesamt konnte gegenüber \textit{Phone Accel} damit eine Verbesserung um $7.8 \%$ erreicht werden, obwohl die Verbesserung einer bereits hohen Genauigkeit herausfordernd ist.\todo{Kann man das belegen?} Gegenüber dem besten Ergebnis eines einzelnen Sensors (\textit{Band accel}) mit $75.2 \%$ liefert die Kombination aller Daten eine Verbesserung um $7.8 \%$.

\todo{Mit weiss vergleichen}

\subsection{Unpersönliche Modelle}
Für die Evaluierung der unpersönlichen Modelle wird eine Kreuzvalidierung über die Nutzer durchgeführt, das heißt der Datensatz $D$ wird für alle Benutzer $b$ aufgeteilt in $D = \text{Train} \uplus \text{Test}$ mit $\text{Train} = \{\text{Intervall ist nicht von } b\}, \text{Test} = D \backslash \text{Train}$.

Das schlechteste Ergebnis wird mit $35.1 \%$ bei den unpersönlichen Modellen erzielt, wenn nur das Gyroskop des Smartphones verwendet wird. Nur wenig besser sind die Modelle, die nur das Beschleunigungssensor des Smartphones ($39.2 \%$) oder beide Sensoren des Smartphones ($41.3 \%$) nutzen. Für den praktischen Gebrauch sind diese Modelle aufgrund ihrer Ungenauigkeit untauglich. Schon rund $20 \%$ besser sind die Modelle, die nur das Gyroskop des Bands nutzen, wobei der Wechsel zum Beschleunigungssensor eine weitere Verbesserung um fast $14 \%$ ermöglicht. Offenbar erklären die Daten des Beschleunigungssensors einen Großteil der Daten, die auch durch das Gyroskop erklärt werden, sodass eine Kombination der beiden Quellen lediglich ein Verbesserung um rund $1 \%$ ermöglicht. Selbiges gilt auch für die Hinzunahme der Daten des Smartphones: Es wird eine Verbesserung um $2 \%$ erzielt, was darauf schließen lässt, dass die Armbewegungen unter den Probanden ähnlich sind, die Bewegungen auf Hüfthöhe weniger. Gegenüber dem besten Ergebnis eines einzelnen Sensors (\textit{Band accel}) mit $75.2 \%$ liefert die Kombination aller Daten eine Verbesserung um $3.3 \%$.

\todo{Mit weiss vergleichen}

\begin{figure}
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|}
	\hline 
	\textbf{Algo.} & \textbf{Phone accel} & \textbf{Phone gyro} & \textbf{Band accel} & \textbf{Band gyro} & \textbf{Comb.} & \textbf{Band comb.} & \textbf{Phone comb.} \\ 
	\hline 
	RF & 88.7 & \textbf{68.2} & \textbf{91.6} & \textbf{80.5} & \textbf{99.4} & \textbf{97.1} & \textbf{90.7} \\ 
	J48 & \textbf{90.0} & 64.3 & 86.5 & 72.7 & 92.8 & 90.1 & 89.7 \\ 
	IB3 & 62.2 & 44.8 & 77.0 & 59.4 & 82.3 & 76.9 & 60.1 \\ 
	NB & 87.6 & 60.4 & 90.9 & 78.8 & 96.2 & 92.2 & 85.5 \\ 
	MLP & 78.9 & 51.5 & 88.9 & 67.8 & 94.8 & 90.7 & 75.1 \\ 
	\hline 
	$\varnothing$ & 81.5 & 57.8 & 87.0 & 71.8 & 93.1 & 89.4 & 80.2 \\ 
	\hline 
\end{tabular}
\caption{Genauigkeit der persönlichen Modelle in Prozent}
\label{fig:accuracy-personal}
\end{figure}

\begin{figure}
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|}
	\hline 
	\textbf{Algo.} & \textbf{Phone accel} & \textbf{Phone gyro} & \textbf{Band accel} & \textbf{Band gyro} & \textbf{Comb.} & \textbf{Band comb.} & \textbf{Phone comb.} \\ 
	\hline 
	RF & \textbf{39.2} & \textbf{35.1} & \textbf{75.2} & \textbf{61.7} & \textbf{78.5} & \textbf{76.5} & \textbf{41.3} \\ 
	J48 & 32.9 & 29.1 & 61.6 & 49.2 & 59.7 & 61.3 & 32.6 \\ 
	IB3 & 24.3 & 22.6 & 60.9 & 45.0 & 52.9 & 58.0 & 26.0 \\ 
	NB & 31.8 & 30.0 & 67.3 & 56.9 & 60.9 & 62.3 & 35.0 \\ 
	MLP & 28.8 & 29.3 & 70.3 & 53.5 & 54.9 & 74.3 & 31.5 \\ 
	\hline 
	$\varnothing$ & 81.5 & 29.2 & 67.1 & 53.3 & 61.4 & 66.5 & 33.3 \\ 
	\hline 
\end{tabular} 
\caption{Genauigkeit der unpersönlichen Modelle in Prozent}
\label{fig:accuracy-impersonal}
\end{figure}

\section{Genauigkeit bei ungenauen Zeitstempeln}
\todo{TODO}

\begin{figure}
\centering
\begin{tabular}{|c|c|c||c|c|}
	\hline 
	\textbf{Algo.} & \textbf{Comb. (Pers.)} & \textbf{Verrauscht (Pers.)} &\textbf{Comb. (Unpers.)} & \textbf{Verrauscht (Unpers.)} \\ 
	\hline 
	RF & \textbf{99.4} & \textbf{99.2} & \textbf{78.5} & \textbf{78.3} \\ 
	J48 & 92.8 & 93.5 & 59.7 & 57.3 \\ 
	IB3 & 82.3 & 81.5 & 52.9 & 52.9 \\ 
	NB & 96.2 & 95.7 & 60.9 & 60.5 \\ 
	MLP & 94.8 & 94.2 & 54.9 & 55.4 \\ 
	\hline 
	$\varnothing$ & 93.1 & 92.8 & 61.4 & 60.9 \\ 
	\hline
\end{tabular} 
\caption{Genauigkeit der Modelle mit verrauschten Band-Zeitstempeln in Prozent}
\label{fig:accuracy-noisy_timestamps}
\end{figure}

\section{Genauigkeit bei einer niedrigen Sampling-Rate}
\todo{TODO}

\begin{figure}
\centering
\begin{tabular}{|c|c|c||c|c|}
	\hline 
	\textbf{Algo.} & \textbf{5 Hz (Pers.)} & \textbf{1 Hz (Pers.)} &\textbf{5 Hz (Unpers.)} & \textbf{1 Hz (Unpers.)} \\ 
	\hline 
	RF & \textbf{98.6} & \textbf{95.3} & \textbf{70.1} & \textbf{62.1} \\ 
	J48 & 93.8 & 87.8 & 53.4 & 48.7 \\ 
	IB3 & 71.0 & 14.6 & 43.5 & 7.8 \\ 
	NB & 91.6 & 75.5 & 53.3 & 44.2 \\ 
	MLP & 90.0 & 78.9 & 63.6 & 51.2 \\ 
	\hline 
	$\varnothing$ & 89.0 & 70.4 & 56.8 & 42.8 \\ 
	\hline
\end{tabular} 
\caption{Genauigkeit der Modelle mit reduzierter Sampling-Rate in Prozent}
\label{fig:accuracy-sampling_rate}
\end{figure}

\section{Genauigkeit bei Überlappung der Intervalle}
Die Überlappung von Intervallen \todo{...} \cite{Bao2004}. \todo{überlappung prozent angeben}

\begin{figure}
\centering
\begin{tabular}{|c|c|c||c|c|}
	\hline 
	\textbf{Algo.} & \textbf{Comb. (Pers.)} & \textbf{Überlappung (Pers.)} &\textbf{Comb. (Unpers.)} & \textbf{Überlappung (Unpers.)} \\ 
	\hline 
	RF & \textbf{99.4} & \textbf{99.2} & \textbf{78.5} & \textbf{73.4} \\ 
	J48 & 92.8 & 96.3 & 59.7 & 57.5 \\ 
	IB3 & 82.3 & 81.8 & 52.9 & 50.7 \\ 
	NB & 96.2 & 95.8 & 60.9 & 59.7 \\ 
	MLP & 94.8 & 95.0 & 54.9 & 59.4 \\ 
	\hline 
	$\varnothing$ & 93.1 & 93.6 & 61.4 & 60.9 \\ 
	\hline
\end{tabular} 
\caption{Genauigkeit der Modelle mit Intervallüberlappung in Prozent}
\label{fig:accuracy-overlap}
\end{figure}

\section{Genauigkeit bei Verschmelzung der Ess- und Trinkaktivitäten}
\begin{figure}
\centering
\begin{tabular}{|c|c|c|}
	\hline 
	\textbf{Algo.} & \textbf{Comb. (Unpers.), verschmolzen} & \textbf{Comb. (Unpers.), nicht verschmolzen} \\ 
	\hline 
	RF & \textbf{87.1} &  \textbf{78.5} \\ 
	J48 & 73.7 &  59.7 \\ 
	IB3 & 63.9 &  52.9  \\ 
	NB & 72.4 & 60.9  \\ 
	MLP & 77.6  & 54.9 \\ 
	\hline 
	$\varnothing$ & 74.9 & 61.4  \\ 
	\hline
\end{tabular} 
\caption{Genauigkeit der Modelle bei Verschmelzung der Ess- und Trinkaktivitäten in Prozent}
\label{fig:accuracy-merge-eating}
\end{figure}
\todo{Confusion-Matrix all impersonal rf einbinden}
Betrachtet man die Konfusionsmatrix der vollständigen unpersönlichen RF-basierten Modelle, so lässt sich feststellen, dass die Klassen, die sich mit Essen oder Trinken beschäftigen, nur ungenau erkannt werden und somit die Durchschnittsgenauigkeit entsprechend senken. Zudem liegt die fehlerhaft vorhergesagte Klasse häufig \todo{Zahl nennen} im Bereich des Essens und Trinkens. Zurückzuführen ist dies auf die Tatsache, dass sich diese Aktivitäten untereinander ähneln, da die zentralen Bewegungsmerkmale das Sitzen sowie das Führen der Hand zum Mund sind.

Abbildung~\ref{fig:accuracy-merge-eating} zeigt, wie sich die Genauigkeit der unpersönlichen Modelle verändert, wenn man diese Aktivitäten zu einer einzigen Aktivität verschmilzt. \todo{Zeige auch neue Konfusionsmatrix.} Bei den RF-Modellen ist eine Verbesserung um $8.6 \%$ zu erkennen, wovon ein Teil auch darauf zurückzuführen sein könnte, dass es insgesamt weniger Klassen gibt und die Wahrscheinlichkeit einer Fehlklassifikation somit sinkt.

Aus diesen Daten lässt sich schließen, dass bei der Verwendung von unpersönlichen Modellen darauf geachtet werden sollte, dass die zu erkennenden Aktivitäten nicht zu feingranular voneinander getrennt werden, da dies die Klassifikation stark erschweren kann.

% vim: set ft=tex
